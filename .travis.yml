sudo: false

language: python

python:
  - 2.7
  - 3.4
  - 3.5
  - 3.6

install:
  # imagepypelines Requirements
  - pip install -r requirements.txt
  - pip install .
  - pip install tensorflow==1.10.0 opencv-python
  # codecov requirements
  - pip install Sphinx sphinx_bootstrap_theme m2r
  # codecov requirements
  - pip install codecov pytest-cov hypothesis

script:
  # license enforcer
  - python enforcer.py
  # running tests and code coverage report
  - py.test --cov=imagepypelines test/
  # Building documentation
  - sphinx-apidoc -o docs/source imagepypelines
  - cd docs && make html
  - cp ../CNAME build/html/CNAME

after_success:
  - codecov

deploy:
  # Website Deployment
  - provider: pages
    skip-cleanup: true
    github-token: $GITHUB_TOKEN
    keep-history: false
    local-dir: docs/build/html
    on:
      branch: master
